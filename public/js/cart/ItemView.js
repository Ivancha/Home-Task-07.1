define(["backbone","backbone.marionette","./template","./Service"],function(e,t,a,i){return t.ItemView.extend({template:a,ui:{input:"input"},events:{"click button[data-action=recalculate]":"recalculate","click button[data-action=order]":"order"},initialize:function(){this.listenTo(this.model,"change",this.render)},_updateCart:function(){this.ui.input.each(function(){i.add(parseInt(this.dataset.id),parseInt(this.value)||0)})},recalculate:function(){this._updateCart(),this.model.fetch({data:i._data})},order:function(){var t=window.prompt("Provide us with your email, please!");if(t){var a=window.prompt("Provide us with your phone number, please!");a&&(this._updateCart(),this.model.save({email:t,phone:a,cart:i._data}).done(function(t){i.removeAll(),e.history.navigate("order/"+t.orderId,{trigger:!0,replace:!0})}))}}})});